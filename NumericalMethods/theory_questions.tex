\documentclass[12pt]{article}

% \usepackage[left=3cm,right=3cm,top=1cm,bottom=2cm]{geometry}
\usepackage{amsmath,amsthm}
\usepackage{amssymb}
\usepackage[T1,T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[bulgarian]{babel}
\usepackage[shortlabels]{enumitem}
\renewcommand{\thesubsection}{\arabic{subsection}}%... from subsections
\numberwithin{equation}{subsection}
\newtheorem{theorem}{Теорема}
\newtheorem{definition}{Дефиниция}
\newtheorem{feature}{Свойство}
\newtheorem{corollary}{Следствие}
\numberwithin{theorem}{subsection}
\numberwithin{definition}{subsection}
\numberwithin{corollary}{subsection}


\begin{document}
\begin{titlepage}
\begin{center}
    \vspace{5em}
    \textbf{\Huge{Развити въпроси за изпит по ЧМ}}\\
    \vspace{2em}
    \LARGE{Информатика при Лозко Милев}
\end{center}
\vfill

Теодора Иванова \hfill \today
\end{titlepage}
\tableofcontents
\pagebreak
\subsection{Формулирайте интерполационната задача на Лагранж. Докажете единствеността. Изведете интерполационната формула на Лагранж.}
  \paragraph{Постановка на задачата\\}
  Нека $x_1,x_2,...,x_n$ са различни точки и $y_1,y_2,...,y_n$ са дадени
  реални числа.
  \par
  Да се построи алгебричен полином $P(x)$ от степен $\leq n$, който удовлетворява следните условия:\\
  \begin{equation} \label{e1}
          P(x_k) = y_k,\hspace{12pt} k=0,\dotso,n 
  \end{equation}
  \theorem Ако съществува решение на \ref{e1}, то трябва да е единствено.
  \proof
  Допускаме, че съществуват два полинома $P$ и $Q$ от степен $n$, които удовлетворяват \ref{e1}, тогава разликата
  \begin{equation*}
  R(x) = P(x) - Q(x)
  \end{equation*}
  ще бъде полином от степен $\leq n$ и освен това 
  \begin{equation*}
  R(x_k) = P(x_k) - Q(x_k) = y_k - y_k = 0,\hspace{12pt}k=0,\dotso,n
  \end{equation*}
  Следователно R е полином от степен $n$, който се анулира в $n+1$ точки. Тогава от основната теорема на алгебрата $R(x)$ е тъждествено равен на 0. Следователно $P\equiv Q$.
  \paragraph{Извеждане на формулата\\}
  При фиксирано $k$ да се намери полинома $l_{nk}(x)\in \pi_n$, който удовлетворява условията:
  \begin{enumerate}
      \item $l_{nk}(x_i) = 0$, за $i = 0, \dotso, n$ и $i \neq k$
      \item $l_{nk}(x_i) = 1$, за $i = k$
  \end{enumerate} 
  От 1. следва, че точките $x_0, \dotso, x_{k-1}, x_{k+1}, \dotso x_n$ са нули на полинома $l_{nk}$. От $l_{nk} \in \pi_n$ следва, че $x_0, \dotso, x_{k-1}, x_{k+1}, \dotso x_n$ са всичките нули. Тогава $l_{nk}$ може да се запише във вида:
  \begin{equation*}
  l_{nk}(x) = A(x - x_0)\dotso(x - x_{k-1})(x - x_{k+1})\dotso(x-x_n),
  \end{equation*}
  където $A$ е някакво число. $A$ се определя от 2..
  \begin{equation*}
  1 = l_{nk}(x_k) = A(x_k - x_0)\dotso(x_k - x_{k-1})(x_k - x_{k+1})\dotso(x_k - x_n)
  \end{equation*}
  \par
  Следователно:
  \begin{equation*}
  A = \frac{1}{\displaystyle \prod_{i=0,i\neq k}^{n}(x_k-x_i)}.
  \end{equation*}
  \par
  Тогава
  \begin{align}\label{e2}
  \begin{split}
  l_{nk}(x) &= \frac{(x - x_0)\dotso(x - x_{k-1})(x - x_{k+1})\dotso (x - x_n)}
  {(x_k - x_0)\dotso(x_k - x_{k-1})(x_k - x_{k+1})\dotso(x - x_n)}\\ &= 
  \displaystyle \prod_{i = 0, i \neq k}^n\left(\frac{x-x_i}{x_k - x_i}\right).
  \end{split}
  \end{align}
  \par
  Полиномите $\{l_{nk}\}_{k = 0}^n$ се наричат базисни полиноми на Лагранж. С тяхна помощ може лесно да се построи $P$.
  \par
  Ще покажем, че решението $P(x)$ на \ref{e1} се дава с 
  \begin{equation}\label{e3}
  P(x) = \displaystyle\sum_{k = 0}^ny_kl_{nk}(x)
  \end{equation}
  \par
  По построение
  \begin{equation*}
  l_{nk}(x_i) = \delta_{ki} = 
  \begin{cases}
  1, &k = i\\
  0, &k \neq i
  \end{cases}
  \end{equation*}
  \par
  Тогава
  \begin{equation*}
  P(x_i) = \displaystyle\sum_{k = 0}^ny_kl_{nk}(x_i) = y_il_{ni}(x_i) = y_i1 = y_i,
  \end{equation*}
  за всяко $i = 0,\dotso,n$. Oт това, че полиномът \ref{e3} е от $\pi_n (l_{nk}\in\pi_n)$ и удовлетворява \ref{e1}, следва,че $P(x)$ даден в \ref{e3} е решение на интерполационната задача.
  \par
  Най-често $\{y_k\}_{k=0}^n$ са стойностите на някаква функция $f(x)$ в точките $x_0, x_1,\dotso, x_n$, тоест
  \begin{equation*}
  y_k = f(x_k),\hspace{12pt}, k = 0, \dotso, n.
  \end{equation*}
  \par
  В такъв случай
  \begin{equation*}
  P(x_k) = f(x_k),\hspace{12pt}, k = 0, \dotso, n
  \end{equation*}
  се бележи с $L_n(f;x)$ и се нарича интерполационен полином на Лагранж за функцията $f$ с възли $x_0, \dotso, x_n$. Казваме още, че $L_n(f;x)$ интерполира $f(x)$ в точките $(x_0, \dotso, x_n)$.
  \par
  И така доказахме следната теорема
  \begin{theorem}\label{T1}
  Нека $x_0 < \dotso < x_n$ и $f(x)$ е определена в тези точки. Тогава съществува единствен полином от $\pi_n$, който интерполира $f$ в $x_0, \dotso, x_n$. Този полином се представя чрез формулата:
  \begin{equation}\label{e4}
  L_n(f;x) = \displaystyle\sum_{k=0}^nf(x_k)
              \displaystyle\prod_{i = 0, i \neq k}^n\frac{x-x_i}{x_k-x_i}
  \end{equation}
  \end{theorem}
  \par
  Формула \ref{e4} се нарича интерполационна формула на Лагранж.
\subsection{Формулирайте и докажете теоремата за оценка на грешката при интерполация на Лагранж.}
  \begin{theorem} \label{T2}
  Нека $[a,b]$ е даден краен интервал и $x_0, \dotso, x_n$ са различни точки в него. Нека функцията $f(x)$ има непрекъсната $(n+1)$-ва производна в $[a,b]$. Тогава $\forall x \in [a,b] \exists \xi \in [a,b] :$
  \begin{equation*}
  f(x)-L_n(f;x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)\dotso(x-x_n).
  \end{equation*}
  \end{theorem}
  \begin{proof}
  \par
  Образуваме помощната функция 
  \begin{equation*}
  F(t) = f(t) - L_n(f;t) - c(t-x_0)\dotso(t-x_n),
  \end{equation*}
  където $c$ е параметър. $F(t)$ се анулира в точките $x_0, \dotso, x_n$ при всеки избор на $c$.
  \begin{equation*}
  F(x_k) = f(x_k) - L_n(f;k) - c.0 = f(x_k) - f(x_k) = 0.
  \end{equation*}
  \par
  Избираме $c$ така, че $F(t)$ да се анулира и при $t=x$. От равенството
  \begin{equation*}
  f(x) - L_n(f;x) - c(x-x_0)\dotso(x-x_n) = 0
  \end{equation*}
  определяме
  \begin{equation}\label{e5}
  c = \frac{R_n(f;x)}{(x-x_0)\dotso(x-x_n)}.
  \end{equation}
  \par
  И така при този избор на $c$ функцията $F(t)$ има поне $n+2$ нули. Това са точките $x, x_0, \dotso, x_n$. По теоремата на Рол $F'(t)$ ще има поне $n+1$ нули, които лежат в интервала $[a,b], F''(t)$ ще има поне $n$ нули и тн. $F^{(n+1)}(t)$ ще има поне една нула, която лежи в $[a,b]$. Да я означим с $\xi$. Имаме $F^{(n+1)}(\xi) = 0$. От друга страна,
  \begin{align*}
  F^{(n+1)}(\xi) &= f^{(n+1)}(\xi) - L_n(f;\xi) - c(n+1)! =\\&= 
  f^{(n+1)}(\xi) - c(n+1)!.
  \end{align*}
  \par
  Следователно
  \begin{equation*}
  c = \frac{f^{(n+1)}(\xi)}{(n+1)!}.
  \end{equation*}
  \par
  Като сравним това равенство с \ref{e5} получаваме:
  \begin{equation*}
  R_n(f;x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_0)\dotso(x-x_n).
  \end{equation*}
  \par
  Теоремата е доказана.
  \end{proof}
\subsection{Дайте определение за полином на Чебишов. Напишете и докажете рекурентната връзка. Намерете нулите на полинома на Чебишов от n-та степен.}
  \begin{definition}Полиномът на Чебишов от първи род от $n-$та степен се бележи с $T_n(x)$ и се определя в интервала $[-1,1]$ чрез равенството 
  \begin{equation}\label{Tpoly}
    T_n(x)=cos(narccos(x)), \hfill x\in[-1,1].
  \end{equation}
  \end{definition}
  Непосредствено от дефиницията следва, че:
  \begin{align*}
    T_0(x) &=1\\
    T_1(x) &=x
  \end{align*}
  Освен това съгласно формулата за събиране на синуси:
  \begin{align*}
    T_{n+1}+T_{n-1}&=cos\left((n+1)arccosx\right)+cos\left((n-1)arccosx\right)\\             &=2cos(arccosx)cos(narccosx)\\
                   &=\boxed{2xT_n(x)},
  \end{align*}
  при всяко $n>1$. Оттук получаваме следната рекурентна връзка
  \begin{equation}\label{recTpoly}
    T_{n+1}=2xT_n(x)-T_{n-1}(x)
  \end{equation}
  Като използваме равенство \ref{Tpoly} веднага можем да намерим нулите на полинома. Очевидно $T_n(x)=0$ при $narcosx=(2k-1)\frac{\pi}{2}, k=0,1,2,\ldots$. Оттук следва, че нулите на полинома са:
  \begin{equation*}
    \xi_k=cos\frac{(2k-1)\pi}{2n}, k=1,\ldots,n.
  \end{equation*}
\subsection{Напишете и докажете интерполационната формула на Нютон с разделени разлики. Напишете задачата, която се решава с тази формула.}
  Ще изведем формулата на Нютон за интерполационни полиноми. За целта разглеждаме разликата:
  \begin{equation*}
  L_{k+1}(f;x) - L_k(f;x),
  \end{equation*}
  където $L_{k+1}(f;x)$ интерполира $f$ в $x_0,\dotso,x_{k+1}$, а $L_k(f;x)$ интерполира $f$ в $x_0,\dotso, x_k$. Ясно е, че $L_{k+1}(f;x) - L_k(f;x)\in\pi_{k+1}$. Освен това
  \begin{equation*}
  L_{k+1}(f;x) - L_k(f;x) = f(x_i) - f(x_i) = 0, \text{за } i = 0,\dotso,k.
  \end{equation*}
  \par
  Следователно $x_0,\dotso,x_k$ са всичките нули на полинома $L_{k+1}(f;x) - L_k(f;x)$. Тогава той може да се запише във вида:
  \begin{equation} \label{e2.3}
  L_{k+1}(f;x) - L_k(f;x) = A(x-x_0)\dotso(x-x_k),
  \end{equation}
  където $A$ е константа. За да намерим $A$ нека сравним коефициентите пред $x^{k+1}$ в \ref{e2.3}.
  \par
  Съгласно теоремата за разделените разлики коефициента пред $x^{k+1}$ в $L_{k+1}(f;x)$ е равен на разделената разлика $f[x_0,\dotso, x_{k+1}]$. Следователно 
  \begin{equation*}
  A = f[x_0,\dotso,x_{k+1}]
  \end{equation*}
  и следователно от \ref{e2.3}
  \begin{equation} \label{e2.4}
  L_{k+1}(f;x) = L_k(f;x) + f[x_0,\dotso,x_{k+1}](x-x_0)\dotso(x-x_k)
  \end{equation}
  \par
  Нека приложим \ref{e2.4} за $k=n-1,n-3,\dotso,2,1,0$. Получаваме следния явен израз за интерполационния полином на Лагранж.
  \begin{align*}
  L_n(f;x) &= f(x_0) + f[x_0,x_1](x-x_0) +\\&+f[x_0,x_1,x_2](x-x_0)(x-x_1)+\dotso+\\&+f[x_0,\dotso,x_n](x-x_0)\dotso(x-x_{n-1})
  \end{align*}
  \par
  Това е интерполационната формула на Нютон. Понякога ще я записваме съкратено така
  \begin{equation}\label{e2.5}
  L_n(f;x) = \displaystyle\sum_{k=0}^nf[x_0,\dotso,x_k](x-x_0)\dotso(x-x_{k-1}),
  \end{equation}
  като приемаме, че $(x-x_0)\dotso(x-x_{k-1}) = 1$ при $k=0$.
  Може и с инфукция наобратно
  Напишете задачата - може би табличката
\subsection{Напишете и докажете формулата на Нютон с крайни разлики за интерполация напред. Напишете задачата, която се решава с тази формула.}
  Нека възлите $\{x_i\}_0^n$ са равноотдалечени и функцията $f$ е дефинирана в тях. Търсим полинома $L_n(f;x)\in\pi_n$, който интерполира $f$ в $x_0,\ldots,x_n$. Съгласно интерполационната фирмула на Нютон:
  \begin{equation*}
    L_n(f;x)=\sum_{k=0}^{n}f[x_0,\ldots,x_k](x-x_0)\ldots(x-x_{k-1}).
  \end{equation*}
  Нека $x_i=x_0 + ih, i=0,\ldots,n$ и $x = x_0+th$.Тогава
  \begin{equation*}
    (x-x_0)\ldots(x-x_{k-1})=\prod_{i=0}^{k-1}(x_0+th-x_0-ih)=h^kt(t-1)\ldots(t-k+1).
  \end{equation*}
  Сега като използваме връзката между разделената разлика и крайната разлика, тоест $f[x_0,\ldots,x_n]=\frac{\Delta^nf_0}{n!h^n}$, получаваме
  \begin{equation*}
    L_n(f;x)=L_n(f;x_0+th)=\sum_{k=0}^{n}\frac{\Delta^kf_0}{k!}t(t-1)\ldots(t-k+1)=\boxed{\sum_{k=0}^{n}\Delta^kf_0\genfrac(){0pt}{0}{t}{k}}.
  \end{equation*}
  Това е формула на Нютон с крайни разлики за интерполиране напред.
  май пак схемата

\subsection{Формулирайте интерполационната задача на Ермит. Докажете, че задачата има единствено решение.}
  Постановка:
  Нека $x_0,\ldots,x_n$ са дадени $n+1$ различни точки и $\nu_0,\ldots,\nu_n$ са цели положителни числа и
  \begin{equation*}
    \{y_{k\lambda}:k=0, \ldots, n, \lambda=0,\ldots,\nu_k-1\}
  \end{equation*}
  е таблица от произволни реални стойностти. Означаваме с $N=\nu_0+\ldots+\nu_n-1$. Да се построи алгебричен полином $P$ от степен $N$, който удовлетворява условията:
  \begin{equation}\label{erm}
    P_{(\lambda)}(x_k)=y_{k\lambda},\hfill k=0, \ldots, n, \lambda=0,\ldots,\nu_k-1.
  \end{equation}
  \theoremПри всеки избор на интерполационни възли $\{x_k\}_0^n, x_i\neq x_j\Leftrightarrow i \neq j$ и при всяка таблица от стойностти $\{y_{k\lambda}\}$ интерполационната задача на Ермит \ref{erm} има единствено решение.
  \proof
  Условията \ref{erm} представляват една система от $N+1 $ линейни уравнения с неизвестни - коефициентите $a_0,\ldots,a_N$ на полинома $P(x)$. Тази система има единствено решение, ако детерминантата ѝ е различна от $0$. Да допуснем, че детерминанатата ѝ е $0$. Тогава хомогенната система:
  \begin{equation*}
    P^{(\lambda)}(x_k) = 0, k=0,\ldots,n \lambda=0,\ldots,\nu_k-1
  \end{equation*}
  ще има някакво ненулево решение $P(x)=a_0x^N+\ldots+a_{N-1}x + a_N$. Но горните условия означават, че $P$ има $N+1$ нули, броейки кратностите. От друга страна $P\in\pi_N$. Следователно $P(x)\equiv0$ и оттук $a_0=\ldots=a_N=0$ и стигаме до противоречие.
\subsection{Формулирайте и докажете рекурентната връзка за разделени разлики с кратни възли. Включително случая, в който всички възли съвпадат.}
\theorem
  Нека $f$ има $k$ непрекъснати производни в $[a,b]$. Тогава за произволни точки $x_0\leq\ldots x_k$ от $[a,b]$ е в сила рекурентната връзка:
  \begin{equation}\label{reqHerm}
    f[x_0,\ldots,x_k] = \begin{cases}
                          \frac{f[x_1,\ldots,x_k]-f[x_0,\ldots,x_{k-1}]}{x_k-x_0}, \hfill x_0<x_k\\
                          \frac{f^{(k)}(x_0)}{k!}, \hfill x_0=x_k
                        \end{cases}
  \end{equation}
\proof
% Нека  $p(x)$ интерполира $f(x)$ в точките $x_0,\ldots,x_k$.
  При $x_0=x_k$ разглеждаме разделената разлика $f[x_0,x_0,\ldots,x_0]$ построяваме полинома $p(x)$ използвайки формулата на Тейлър:
  \begin{equation*}
    p(x) = f(x_0)+\frac{f'(x_0)}{1!}(x-x_0)+\ldots+\frac{f^{(k)}(x_0)}{k!}(x-x_0)^k,
  \end{equation*}.
  Този полином удовлетворява условието $p^(j)(x_0)=f^{(j)}(x_0), j=0,\ldots,k.$
  С други думи полиномът $p$ интерполира $f$ в точката $x_0$ с кратност $k+1$. От явния вид на $p$ се вижда, че коефициента пред $x^n$ е $\frac{f^{(k)}(x_0)}{k!}$. И от това, че разделената разлика е равна на коефициента пред $x^n$ следва, че 
  \begin{equation*}
    f[x_0,\ldots,x_k]=\frac{f^{(k)}(x_0)}{k!} \text{при } x_0=\ldots=x_k
  \end{equation*}
  Нека $x_0<\ldots<x_k$ и тъй като разделената разлика е линеен функционал,то
  \begin{align*}
    (x_k-x_0)f[x_0,\ldots,x_k]&=\{(x_k-x+x-x_0)f\}[x_0,\ldots,x_k]\\
    &=(x_k-x)f[x_0,\ldots,x_k]+\{x-x_0f\}[x_0\ldots,x_k]\\
    &=-f[x_0,\ldots,x_{k-1}]+f[x_1,\ldots,x_k]
  \end{align*}
  Следователно
  \begin{equation*}
    \frac{f[x_1,\ldots,x_k]-f[x_0,\ldots,x_{k-1}]}{x_k-x_0}
  \end{equation*}
\subsection{Напишете и докажете, формулата за интерполационния тригонометричен полином при произволно разположени интерполационни възли в $[0, 2\pi)$. Напишете задачата, която се решава с тази формула.}
  \theorem Нека $0\leq x_0<x_1<\ldots<x_{2n}<2\pi$. Тогава за всяка функция $f$ определена в точките $\{x_i\}_0^{2n}$ съществува единствен тригонометричен полином $t_n$ от ред $n$ такъв, че
  \begin{equation}\label{interp}
    t_n(x_i)=f(x_i), \hfill i=0,\ldots,2n
  \end{equation}
  и той има вида
  \begin{equation}\label{trigpoly}
    t_n(x) = \sum_{k=0}^{2n}\lambda_kf(x_k)
  \end{equation}
  където
  \begin{equation}\label{lambdatrig}
    \lambda_k=\prod_{i=0,i\neq k}^{2n}\frac{sin\left(\frac{x-x_i}{2}\right)}{sin\left(\frac{x_k-x_i}{2}\right)}
  \end{equation}
  \proof
  Функциите $\lambda_k$ удовлетворяват условията
  \begin{align*}
    \lambda_k(x_i)&=0, \text{за } i\neq j\\
    \lambda_k(x_i)&=1, \text{иначе}.
  \end{align*}
  От това следва, че изразът \ref{trigpoly} ще удовлетворява интерполационните условия \ref{interp}. Остава само да докажем, че $\lambda_k$, следователно и $t_n$ са тригонометрични полиноми от ред $n$. За целта ще използваме индукция по $n$.\\
  При $n=1$ :
  \begin{align*}
     \lambda_k(x_1) &= sin\left(\frac{x-\alpha}{2}\right)sin\left(\frac{x-\beta}{2}\right) \\
     &= \frac{1}{2}\left(cos\frac{\beta-\alpha}{2}-cos\left(x-\frac{\alpha+\beta}{2}\right)\right) \\
     &= \boxed{a_0+a_1cosx+b_1sinx}
  \end{align*}
  Следователно $\lambda_k(x)$ е тригонометричен полином от ред $1$.\\
  Допускаме, че всяко едно произведение от $n-1$ двойки синуси е тригонометричен полином от ред $n-1$. Да разгледаме произволен израз за $\lambda_k(x)$ от вид \ref{lambdatrig}. Той може да се запише по следния начин:
  \begin{align*}
    \lambda_k(x)&=c\prod_{i=0, i\neq k}^{2n}sin\left(\frac{x-x_i}{2}\right)\\
    &=C\left\{\prod_{i=1}^{n-1}sin\left(\frac{x-\alpha_i}{2}sin\left(\frac{x-\beta_i}{2}\right)\right)\right\}\left\{sin\left(\frac{x-\alpha}{2}sin\left(\frac{x-\beta}{2}\right)\right)\right\},
  \end{align*}
  където $C$ е константа. Но съгласно идукционното предположение и двата израза в големите скоби са тригонометрични полиноми от ред $n-1$ и $1$ съответно и следователно:
  \begin{align*}
    \lambda_k(x)&= \left(a_0+\sum_{k=1}^{n-1}(a_kcos(kx)+b_ksin(kx))\right)(a_0+a_1cosx+b_1sinx)\\
    &=a_0^2+a_0a_1cosx+a_0b_1sinx + \sum_{k=1}^{n-1}\bigl(a_ka_0cos(kx)+b_ka_0sin(kx)\\
    &+a_ka_1cosxcos(kx)+b_ka_1cosxsin(kx)\\
    &+a_kb_1sinxcos(kx)+b_kb_1sinxsin(kx)\bigr)\\
    &=a_0^2+a_0a_1cosx+a_0b_1sinx + \sum_{k=1}^{n-1}\bigl(a_ka_0cos(kx)+b_ka_0sin(kx)\\
    &+a_ka_1\frac{1}{2}(cos(k-1)x+cos(k+1)x)\\
    &+b_ka_1\frac{1}{2}(sin(k+1)x-sin(k-1)x)+a_kb_1\frac{1}{2}(sin(k+1)x-sin(k-1)x)\\
    &+b_kb_1\frac{1}{2}(cos(k-1)x-cos(k+1)x))\\
    &=A_0+A_1cosx+B_1sinx+\sum_{k=1}^{n-1}A_{k-1}cos(k-1)x\\
    &+B_{k-1}sin(k-1)x+A_kcos(kx)+B_ksin(kx)+A_{k+1}cos(n+1)x+B_{k+1}sin(n+1)x
  \end{align*}
  Очевидно $\lambda_k(x)$ е линейна комбинация на $sinkx, coskx, k=0,\ldots,n$, което означава, че $\lambda_k$ е тригонометричен полином от ред $n$. Следователно и $t_n$ също е тригонометричен полином от ред $n$ изпълняващ условята \ref{interp} за интерполация.
\subsection{Формулирайте и докажете теоремата за представяне на сплайн функция,
като линейна комбинация на полиноми и отсечени степенни функции.}
  \begin{definition}
    Функцията $s(x)$ се нарича сплайн функция от степен $r$ с възли $x_1<\ldots<x_n$, ако:
    \begin{enumerate}
      \item{$s(x)$ е полином от степен най-много $r$ във всеки подинтервал $(x_i,x_{i+1}), i=0,\ldots,n (x_0=-\infty,x_n=+\infty)$}
      \item{$s(x), s'(x), \ldots, s^{(r-1)}(x)$} са непрекъснати функции в $(-\infty, +\infty)$
    \end{enumerate}
  \end{definition}
  \begin{definition}
    $S_r(x_1,\ldots,x_n)$ отбелязва множеството от сплайн-функции от степен $r$ свъзли в точките $x_1,\ldots,x_n$. 
  \end{definition}
  \begin{definition}
    Отсечената степенна функция :
    \begin{equation*}
      (x-\xi)^r_+=\begin{cases}
                    (x-\xi)^r\hfill, x\geq\xi\\
                    0\hfill,x<\xi
                  \end{cases}
    \end{equation*}
    е сплайн от степен $r$ с единствен възел в точката $\xi$.
  \end{definition}
  \theoremВсяка сплайн функция $s(x)$ от класа $S_r(x_1,\ldots,x_n)$ се представя по единствен начин от вида:
  \begin{equation}\label{spline}
    s(x)=p(x)+\sum_{k=1}^{n}c_k(x-x_k)_+^r,
  \end{equation}
  където $p(x)$ е полином от степен $r, a c_1,\ldots,c_n$ са реални числа:
  \begin{equation}
    c_k=\frac{s^{(k)}(x_k+0)-s^{(r)}(x_k-0)}{r!}, k=1,\ldots,n
  \end{equation}
  \proof
  Означението $f(x+0)=\lim_{h\to0,h>0}f(x+h)$ и аналогично е за $f(x-0)$.
  Нека $s(x)\in S_r(x_1,\ldots,x_n).$ Тогава $s$ съвпада с някакъв полином $P_k$ от степен $r$ в подинтервала $(x_k, x_{k+1}), k=0,\ldots,n$. Тъй като $s^{(j)}(x)$ е непрекъсната функция в точката $x_k$, то $P^{(j)}_{k-1}(x_k)=P_{k}^{(j)}(x_k), j=0,\ldots,r-1$. Следователно
  \begin{equation}\label{recSpline}
    P_k(x)=P_{k-1}(x)+c_k(x-x_k)^r, \forall x,
  \end{equation}
  където $c_k$ е някаква константа. От тази рекурентна връзка следва, че 
  \begin{equation*}
    P_k(x)=P_0(x)+\sum_{i=1}^{k}c_i(x-x_i)^r.
  \end{equation*}
  Като вземем предвид, че $s(x)\equiv P_k(x), x\in(x_k,x_{k+1})$ и определението за отсечена функция от горното равенство получаваме
  \begin{equation*}
    s(x)=P_0(x)+\sum_{i=0}^{n}c_i(x-x_i)_+^r,
  \end{equation*}
  което е търсенео представяне. Остава да покажем, че коефициентите $c_k$ се определят еднозначно.
  Диференцираме \ref{recSpline} $r-$пъти в точката $x_k$ и получаваме:
  \begin{equation*}
    P^{(r)}_k=P_{k-1}^{(r)}(x_k)+c_kr!
  \end{equation*}
  и оттук
  \begin{equation*}
    c_k=\frac{s^{(k)}(x_k+0)-s^{(r)}(x_k-0)}{r!}.
  \end{equation*}
  Полиномът $p(x)$ в \ref{spline} се определя също еднозначно и съвпада с $P_0(x).$
\subsection{Напишете и докажете рекуретната връзка за B-сплайните}
  \begin{definition}
    Разделената разлика на отсечената степенна функция $(x-t)_+^{r-1}$ по отношение на $x$ в точките $x_1< \ldots< x_r$ се нарича $B-$сплайн от степен $r-1$ с възли $x_0,\ldots,x_r$.
  \end{definition}
  \theorem
  За всяко $r\geq2$ и $t\in(-\infty,\infty)$ е в сила равенството:
  \begin{equation}\label{bSplineRec}
    B_{i,r-1}(t)=\frac{t-x_i}{x_{i+r}-x_i}B_{i,r-2}(t)+\frac{x_{i+r}-t}{x_{i+r}-x_i}B_{i+1,r-2}(t).
  \end{equation}
  \proof
  Ще използваме правилото на Сефансон за намиране на разделената разлика на произведение на функции:
  \begin{equation*}
    (f.g)[x_0,\ldots,x_n]=\sum_{k=0}^{n}f[x_0,\ldots,x_k]g[x_k,\ldots,x_n].
  \end{equation*}
  Избираме $f(x)=x-t$ и $g(x)=(x-t)_+^{r-2}$. Очевидно
  \begin{equation*}
    f(x)g(x)=(x-t)_+^{r-1}, x\in(-\infty, \infty)
  \end{equation*}
  и следователно
  \begin{equation*}
    B_{i,r-1}(t)=(f.g)[x_i,\ldots,x_{i+r}]=f(x_i)g[x_i,\ldots,x_{i+r}]+f[x_i,x_{i+1}]g[x_{i+1}, \ldots,x_{i+r}],
  \end{equation*}
  тъй като $f[x_i,\ldots,x_{i+k}]=0, k\geq2$. Като вземем предвид, че $f[x_i,x_{i+1}]=1$ и рекурентната връзка за разделените разлики получаваме:
  \begin{align*}
    B_{i,r-1}(t)&=f(x_i)\frac{g[x_{i+1},\ldots, x_{i+r}]-g[x_i,\ldots,x_{r+i-1}]}{x_{i+r}-x_i}+g[x_{i+1,\ldots,x_i+r}]\\
    &=\left(1+\frac{f(x_i)}{x_{x+r}-x_i}\right)g[x_{i+1},\ldots,x_{i+r}]-\frac{f(x_i)}{x_{i+r}-x_i}g[x_i,\ldots,x_{i+r-1}]\\
    &=\frac{x_{i+r}-t}{x_{i+r}-x_i}B_{i+1,r-2}(t)+\frac{t-x_i}{x_{i+r}-x_i}B_{i,r-2}(t).
  \end{align*}
\subsection{Формулирайте теоремата на Чебишов за алтернанса. Докажете достатъчността.}
  \theoremНека $f $ е произволна непрекъсната функция в крайния и затворен интервал $[a,b]$. Необходимо и достатъчно условие е полиномът $P\in\pi_n$ да бъде полином на най-добро равномерно приближение за $f $ от $n-$та степен в $[a,b]$ е да съществува $n+2$ точки $\{x_i\}_0^{n+1}\in[a,b]:a\leq x_0<\ldots<x_n\leq b$ и
  \begin{equation}\label{alternans}
    f(x_i)-P(x_i)=(-1)^i\epsilon||f-P||,\hfill i=0,\ldots,n+1,
  \end{equation}
  където $\epsilon=1$ или $\epsilon=-1$.
  \proof
  Условието \ref{alternans} означава, че разликата $f(x)-P(x)$ достига максимумалата си по модул стойност в $n+2$ точки, като си сменя алтернативно знака. В такъв случай казваме, че $f$ и $P$ осъществяват алтернанс в $n+2$ точки.
  Достатъчност на \ref{alternans}.\\
  Нека $P$ удовлетворява \ref{alternans}, тоест съществува $n+2$ точки $\{x_i\}_0^{n+1}\in[a,b]:a\leq x_0<\ldots<x_n\leq b$ и $f(x_i)-P(x_i)=(-1)^i\epsilon||f-P||,\hfill i=0,\ldots,n+1$,където $\epsilon=1$ или $\epsilon=-1$. Тогава е изпълнено:
  \begin{equation*}
    E_n(f)\geq ||f-P||.
  \end{equation*}
  Но, по определение, $E_n(f)\leq||f-Q||,\forall Q\in\pi_n$. Следователно $E_n(f)=||f-P||$ и $P$ e полином на най-добро равномерно проближение 
\subsection{Формулирайте теоремата на Вайерщрас. Докажете я като използвате полиномите на Бернщайн.}
  \begin{definition}
    Нека $f(x)$ е произволна функция, дефинирана в интервала $[0,1]$. Полиномът на Бернщайн от степен $n$ за функцията $f$ се бележи с $B_n(f;t)$ и се определя с равенството:
    \begin{equation*}
      B_n(f;t)=\sum_{k=0}^{n}f\left(\frac{k}{n}\right)\genfrac(){0pt}{0}{n}{k}t^k(1-t)^{n-k}
    \end{equation*}
  \end{definition}
  \begin{definition}
    Нека $f$  е функция дефинирана в $[a,b]$. Величината:
    \begin{equation*}
      w(f;\delta)=sup{|f(x)-f(y)|:x,y\in[a,b], |x-y|\leq\delta}
    \end{equation*}
    се нарича модул на непрекъснатост на $f $ в $[a,b]$.
  \end{definition}
  \theoremНека $f$ е произволна непрекъсната функция в $[0,1]$. Тогава за всяко $n$ и всяко $t\in[0,1]$ имаме
  \begin{equation}\label{th2}
    |f(t)-B_n(f;t)|\leq\frac{3}{2}w\left(f;\frac{1}{\sqrt n}\right)
  \end{equation}
  \theoremНека $[a,b]$ е произволен краен интервал и $f(x)$ е непрекъсната функция в него. Тогава $\forall\epsilon>0$ съществува алгебричен полином $P(x)$ такъв, че:
  \begin{equation*}
    \underset{x\in[a,b]}{max}|f(x)-P(x)|\leq\epsilon.
  \end{equation*}
  \proof
  Въвеждаме функцията:
  \begin{equation*}
    h(t)=f(a+t(b-a)), t\in[0,1].
  \end{equation*}
  Тъй като $f(x)$ е непрекъсната в $[a,b]$, то и $h(t)$ ще е непрекъсната в $[0,1]$ и следователно
  \begin{equation*}
    \lim_{\delta\to0}w(h,\delta) = 0.
  \end{equation*}
  Тогава $\exists n:$
  \begin{equation*}
    \frac{3}{2}w\left(h;\frac{1}{\sqrt n}\right)<\epsilon
  \end{equation*}
  От теорема \ref{th2}
  \begin{equation*}
    |h(t)-B_n(h;t)|\leq\frac{3}{2}w\left(h;\frac{1}{\sqrt n}\right)<\epsilon
  \end{equation*}
  за това $n$. Тоест полинома $B_n(h;t)$ приблицава $h$ в $[0,1]$ с точност $\epsilon$. Сега, като се върнем обратно към променливата $x $ със смяната $t=\frac{x-a}{b-a}$, получаваме:
  \begin{equation*}
    \left|
    h\left(\frac{x-a}{b-a}\right) - B_n\left(h;\frac{x-a}{b-a}\right)
    \right|<\epsilon, x\in[a,b].
  \end{equation*}
  Където $f(x)=h\left(\frac{x-a}{b-a}\right)$ и $P(x)=B_n\left(h;\frac{x-a}{b-a}\right)$ са алгебрични полиноми от степен $n$. Тогава $P(x)$ е полином, за който
  \begin{equation*}
    |f(x)-P(x)|<\epsilon, x\in[a,b].
  \end{equation*}
  Доказателството е завършено.
\subsection{Напишете и докажете тричленната рекуретната връзка за редица от ортогонални полиноми.}
  \featureЗа всяка система от ортогонални полиноми $P_0(x), P_1(x)\ldots$ съществува тричленна рекурентна връзка от вида:
  \begin{equation}\label{recOrtPoly}
    P_{n+1}=(A_nx-B_n)P_n(x)+C_nP_{n-1}(x), n=1,2,\ldots,
  \end{equation}
  където $A_n, B_n, C_n$ са константи.
  \proof
  \begin{equation*}
    xP_n(x)=a_0P_0(x)+\ldots+a_nP_n(x)+a_{n+1}P_{n+1}(x)
  \end{equation*}
  с някакви константи $a_0, \ldots, a_{n+1}$. Умножаваме с $P_i(x)$ и интегрираме. Получаваме:
  \begin{align}\label{ortPoly}
    \int_{a}^{b}\mu(x)xP_n(x)P_i(x)dx = a_i(P_i,P_i), i=0,\ldots, n+1.
  \end{align}
  Като интеграла е равен на $0$ за $i=0,\ldots, n-2$ от ортогоналността и $P_{i}\in\pi_{n-1}$. Следователно $a_i=0$ при $i=0,\ldots,n-2$ и
  \begin{align}\label{ortPoly2}
    xP_n(x)=a_{n-1}P_{n-1}(x)+a_nP_n(x)+a_{n+1}P_{n+1}(x).
  \end{align}
  Така получаваме търсената връзка, а за коефициентите от \ref{ortPoly}
  \begin{align*}
    a_{n-1}&=\frac{(xP_n,P_{n-1})}{(P_{n-1},P_{n-1})}\\
    a_n    &=\frac{(xP_n,P_n)}{(P_n, P_n)}
  \end{align*}
  и от \ref{ortPoly2} $a_{n+1}=\frac{\alpha_n}{\alpha_{n-1}}$, ако $P_k(x)=\alpha_kx^k+\ldots\in\pi_{k-1}, k=0,1,\ldots$.
\subsection{Формулирайте и докажете теоремата за характеризация на елемента на най-добро приближение в Хилбертово пространство. (НДУ)}
  \theorem
  Нека $H$ е произволно хилбертово пространство и $f\in H$. Елементът $p\in\Omega_n$ е елемент на най-добро проближение за $f$ с елемент от $\Omega_n$ тогава и само тогава, когато
  \begin{equation}\label{ndp}
    (f-p,\phi)=0, \forall\phi\in\Omega_n.
  \end{equation}
  \proof
  ($\Rightarrow$)\\
  Да предположим, че $p$ е елемент на най-добро приближение, тоест
  \begin{equation*}
    ||f-p||=inf\{||f-\phi||:\phi\in \Omega_n\} = \epsilon_n(f).
  \end{equation*}
  Тогава за произволно $\phi\in\Omega_n$ и $\phi\neq0$ функцията:
  \begin{align*}
    r(\lambda)=||f-p+\lambda\phi||^2=(f-p+\lambda\phi,f-p+\lambda\phi)\\
    &=\epsilon_n^2(f) + 2\lambda(f-p,\phi) +\lambda^2(\phi,\phi)
  \end{align*}
  ще има минимум при $\lambda=0$. Това означава, че и $r'(0)=0$. Но $r'(0)=2(f-p,\phi)$, следователно
  $(f-p,\phi)=0, \forall\phi\in\Omega_n$
  ($\Leftarrow$)\\
  Да допуснем, че $p\in\Omega_n$ и $p$ удовлетворява условията за ортогоналност \ref{ndp}. Нека $\phi$ e произволен друг елемент от $\Omega_n$. Тогава $\delta=p-\phi\in\Omega_n$ и следователно
  \begin{align*}
    ||f-\phi||^2&=||f-p+p-\phi||^2\\&=(f-p+\delta,f-p+\delta)=||f-p||^2+||\delta||^2 \text{(защото} (f-p)\perp\delta)\\
    &\geq||f-p||^2
  \end{align*}
  И така, ако $p$ удовлетворява \ref{ndp}, то
  \begin{equation*}
    ||f-p||\leq||f-\phi||,\hfil\forall\phi\in\Omega_n
  \end{equation*}
  Като равенство се достига само при $\delta=0$, тоест когато $p\equiv\phi$.
\subsection{Изведете формулата от вида $f'(a)\approx C_0 f(a - h) + C_1 f(a + h)$ и грешката $O(h^2)$ при положение, че $f$ е достатъчно гладка.
        Обосновете порядъка на грешката.}
  Нека $f(t)$ е дефинирана в $[a-h,a-h]$ и $x_0=a-h,x_1=a+h$  са различни възли на интерполация симитрични спрямо точката $a$. Търсим приближение на $f'(a)$.
  Съгласно формулата на Нютон
  \begin{equation*}
    f(t) = L_1(f;t)+f[a-h,a+h,t](t-a+h)(t-a-h)
  \end{equation*}
  Очевидно 
  \begin{equation*}
    L_1(f;t)=f(a-h)+f[a-h,a+h](t-a+h).
  \end{equation*}
  Следователно $f'(a)\approx L_1'(a)=f[a-h,a+h]$ и получаваме следната формула за приближение от търсения вид:
  \begin{equation*}
    f'(a)=\frac{f(a+h)-f(a-h)}{2h}
  \end{equation*}
  Тогава за грешката имаме 
  \begin{align*}
    E(f) &=(f[a-h,a+h,t](t-a+h))'\\
         &=f[a-h,a+h,t,t](t-a+h)(t-ah) + f[a-h,a+h,t]2(x-a)\\
    E(a) &=f[a-h,a+h,t,t](a-a+h)(a-a-h) = \frac{f^{(3)}(\xi)}{3!}(-h^2)\\
         &=\boxed{-\frac{f^{(3)}(\xi)}{6}h^2}
  \end{align*}
  От $E(a)\to0$ при $h^2\to0$, следва, че порядъка на грешката е $o(h^2)$.
\subsection{Изведете елементарната квадратурна формула на трапеца и оценката на грешката при подходящи предположения за подинтегралната функция.}

\subsection{Формулирайте и докажете теоремата за квадратурната формула на Гаус.}
  \theorem При всяко естествено число $n$ съществува единствена квадратурна формула от вида:
    \begin{equation}\label{gausQ}
      \int_{a}^{b}\mu(x)f(x)dx\equiv\sum_{k=1}^{n}A_kf(x_k),
    \end{equation}
  където $\mu(x)$ е дадено тегло, дефинирано в $[a,b], a\leq x_1<x_2<\ldots<x_n\leq b, a \{A_k\}_1^n\in\mathbb R$ с алгебрична степен на точност $2n-1$. Възлите $\{x_k\}_1^n$ на тази формула са нулите на полинома от степен $n$, ортогонален $[a,b]$ с тегло $\mu(x)$ на всички алгебрични полиноми от степен $n-1$.
  \proof
  ($\Leftarrow$)Нека $w(x)$ е полином от степен $n$, с коефициент $1$ пред $x_n$ , който е ортогонален в $[a,b]$ с тегло $\mu(x)$ на всички полиноми от степен $n-1$ и нека $x_1,\ldots,x_n$ са неговите нули, тоест $w(x) = (x-x_1)\ldots(x-x_n)$. Ще построим интерполационната квадратурна формула от вида \ref{gausQ} с възли нулите $\{x_k\}_1^n$ на $w(x)$ и  ще покажем, че тази формула има АСТ$=2n-1$.
  Нека $f$ е произволен полином от степен $2n-1$. Разделяме $f(x)$ на $w(x)$ и получаваме:
  \begin{equation}
    f(x)=w(x)q(x)+r(x),
  \end{equation}
  където $q$ и $r$ са полиноми от по-малка или равна на $n-1$. Тогава:
  \begin{equation*}
    \int_{a}^{b}\mu(x)f(x)dx=\int_{a}^{b}\mu(x)w(x)q(x)dx+\int_{a}^{b}\mu(x)r(x)dx.
  \end{equation*}
  От $w(x)$ ортогонален на $q(x)$, следва че:
  \begin{equation*}
    \int_{a}^{b}\mu(x)f(x)dx=\int_{a}^{b}\mu(x)r(x)dx
  \end{equation*}
  Формула \ref{gausQ} е точна за $r(x)$, тогава
  \begin{equation*}
    \int_{a}^{b}\mu(x)r(x)dx=\sum_{k=1}^{n}A_kr(x_k)
  \end{equation*}
  От $w(x_k)=0$, следва, че $r(x_k)=f(x_k)$.Получаваме
  \begin{equation*}
    \int_{a}^{b}\mu(x)f(x)dx = \sum_{k=1}^{n}A_kf(x_k)
  \end{equation*}
  Квадратурната формула е точна за всяко $f(x)\in\pi_{2n-1}$ следователно АСТ$=2n-1.$\\
  $\Rightarrow$
  Нека квадратурната формула \ref{gausQ} има АСТ$=2n-1$. Ще покажем, че полинома $w(x)=(x-x_1)\ldots(x-x_n)$ е ортогонален на всеки полином от $\pi_{n-1}$.Тогава полиномът $f(x)=Q(x)w(x)$ е от степен $2n-1$ и квадратурната формула ще бъде точна за него.Имаме
  \begin{equation*}
    \int_{a}^{b}\mu(x)Q(x)w(x)dx=\sum_{k=1}^{n}A_kQ(x_k)w(x_k)=0,
  \end{equation*}
  тоест $w(x)$ е ортогонален на $Q(x)$.
  Единствеността на полинома с най-висока АСТ,  тоест $2n-1$, следва от единствеността на полинома $w(x)=(x-x_1)\ldots(x-x_n)$, ортогонален на всички полиноми от $\pi_{n-1}$.
\subsection{Формулирайте и докажете теоремата за приближено решаване
на нелинейно изображение по метода свиващото изображение.}
  \theorem Нека $\phi$ е непрекъснато изображение на $[a,b]$ в себе си, което удовлетворява условието на Липшиц с константа $q<1$. Тогава
  \begin{enumerate}[a]
    \item{Уравнението $x=\phi(x)$ има единствен корен $\xi\in[a,b]$;}
    \item{Редицата $\{x_n\}$ клони към $\xi$ при $n\rightarrow\infty$.}
  \end{enumerate}
  Нещо повече
  \begin{equation}\label{sviz}
    |x_n-\xi|\leq(b-a)q^n, \forall n
  \end{equation}
  \proof
    От това, че $\phi$ е непрекъснато изображение на интервала $[a,b]$ в себе си следва, че $\phi$ има неподвижна точка в $[a,b].$
    Да допуснем, че неподвижните точки са повече от една. Нека $\xi_1=\phi(\xi_1),\xi_2=\phi(\xi_2)$, за някои $\xi_1,\xi_2\in[a,b]$. Тогава при $\xi_2\neq\xi_2$:
    \begin{align*}
      |\xi_1-\xi_2|&=|\phi(\xi_1)-\phi(\xi_2)|\\
                   &\leq q|\xi_1-\xi_2|\text{ (по условие на Липшиц)}
                   &<|\xi_1-\xi_2|\text{ (от $q<1$)}
    \end{align*}
    И достигнахме до противоречие, следователно в интервала $[a,b]$ имаме единствена неподвижна точка $\xi$.
    Ще докажем оценката \ref{sviz}, от която следва b. Имаме
    \begin{align*}
      |x_n - \xi|&=|\phi(x_{n-1})-\phi(\xi)|\leq q|x_{n-1}-\xi|\\
                 &=q|\phi(x_{n-2})-\phi(\xi)|\leq q^2|x_{n-3}-\xi|\\
                 &\ldots\\
                 &\leq q^n|x_0-\xi|
    \end{align*}
    От $x_0\in[a,b]$ и $\xi\in[a,b]$, то $|x_0-\xi|<b-a$
\end{document}
